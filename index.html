<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>8-Bit Sasquatch Escape</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Facebook/Twitter sharing meta tags -->
    <meta property="og:title" content="8-Bit Sasquatch Escape">
    <meta property="og:description" content="Help Sasquatch escape hunters in this retro puzzle game!">
    <meta property="og:url" content="https://cptwow42.github.io/Sasquatch-Escape/">
    <meta property="og:type" content="website">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="8-Bit Sasquatch Escape">
    <meta name="twitter:description" content="Help Sasquatch escape hunters in this retro puzzle game!">
    
    <!-- Redirect Facebook/Instagram apps -->
    <script>
        if (navigator.userAgent.match(/FBAN|FBAV|Instagram|Messenger/i)) {
            setTimeout(function() {
                alert("For best experience, open in your phone's browser (Chrome/Safari).");
            }, 1000);
        }
    </script>
</head>
<body>
    <div id="gameContainer">
        <div id="ui">
            <div id="level">Level: <span id="levelNumber">1</span></div>
            <div id="hunters">Hunters: <span id="hunterCount">1</span></div>
            <div id="message"></div>
        </div>
        
        <div id="gameBoard"></div>
        
        <div id="controls">
            <button id="makeNoise">Make Noise (N)</button>
            <button id="bangTree">Bang Tree (B)</button>
            <button id="eatMushroom">Eat Mushroom (M) <span id="mushroomCount">0</span></button>
        </div>
        
        <!-- Mobile Touch Controls -->
        <div id="mobileControls" class="hidden">
            <div class="touch-controls">
                <div class="d-pad">
                    <button class="touch-btn up" data-direction="up">↑</button>
                    <div class="middle-row">
                        <button class="touch-btn left" data-direction="left">←</button>
                        <button class="touch-btn right" data-direction="right">→</button>
                    </div>
                    <button class="touch-btn down" data-direction="down">↓</button>
                </div>
            </div>
        </div>
        
        <div id="instructions">
            <p>Use ARROW KEYS to move Sasquatch. Hide behind trees (dark green). Avoid hunters in orange.</p>
            <p class="mobile-instruction">On mobile: Use the touch controls above to move.</p>
        </div>
    </div>

    <!-- Start Screen -->
    <div id="startScreen" class="screen">
        <div class="screenContent">
            <h1>8-Bit Sasquatch Escape</h1>
            <p>Help the Sasquatch return to its cave without being seen by hunters!</p>
            <button id="startButton">Start Game</button>
            <p style="margin-top: 15px; font-size: 14px; color: #ccc;">Or press ENTER to start</p>
            <p class="mobile-instruction" style="margin-top: 10px; font-size: 12px; color: #aaa;">On mobile: Tap Start Game button</p>
        </div>
    </div>

    <!-- Level Complete Screen -->
    <div id="levelCompleteScreen" class="screen hidden">
        <div class="screenContent">
            <h1>Level Complete!</h1>
            <p>You made it back to the cave safely!</p>
            <button id="nextLevelButton">Next Level</button>
            <p style="margin-top: 15px; font-size: 14px; color: #ccc;">Or press ENTER to continue</p>
        </div>
    </div>

    <!-- Game Over Screen -->
    <div id="gameOverScreen" class="screen hidden">
        <div class="screenContent">
            <h1>Game Over!</h1>
            <p>You were spotted by a hunter!</p>
            <button id="restartButton">Play Again</button>
            <p style="margin-top: 15px; font-size: 14px; color: #ccc;">Or press ENTER to restart</p>
        </div>
    </div>

    <script src="script.js" defer></script>
    
    <script>
        // Mobile touch controls initialization
        document.addEventListener('DOMContentLoaded', function() {
            const mobileControls = document.getElementById('mobileControls');
            
            // Better mobile detection
            function isMobileDevice() {
                return (window.innerWidth <= 768) ||
                       ('ontouchstart' in window) ||
                       (navigator.maxTouchPoints > 0) ||
                       /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            }
            
            // Show mobile controls on mobile devices
            if (isMobileDevice()) {
                mobileControls.classList.remove('hidden');
                
                // Adjust game board for mobile
                const gameBoard = document.getElementById('gameBoard');
                if (gameBoard) {
                    const availableWidth = window.innerWidth - 40;
                    const cellSize = Math.max(18, Math.floor(availableWidth / 15));
                    gameBoard.style.gridTemplateColumns = `repeat(15, ${cellSize}px)`;
                    gameBoard.style.gridTemplateRows = `repeat(15, ${cellSize}px)`;
                }
                
                // Add touch event handlers for movement
                document.querySelectorAll('.touch-btn').forEach(button => {
                    button.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        this.classList.add('active');
                        const direction = this.dataset.direction;
                        // Simulate arrow key press
                        const event = new KeyboardEvent('keydown', {
                            key: 'Arrow' + direction.charAt(0).toUpperCase() + direction.slice(1),
                            bubbles: true
                        });
                        window.dispatchEvent(event);
                    });
                    
                    button.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        this.classList.remove('active');
                    });
                    
                    button.addEventListener('touchcancel', function(e) {
                        this.classList.remove('active');
                    });
                    
                    // Mouse support for testing
                    button.addEventListener('mousedown', function(e) {
                        e.preventDefault();
                        this.classList.add('active');
                        const direction = this.dataset.direction;
                        const event = new KeyboardEvent('keydown', {
                            key: 'Arrow' + direction.charAt(0).toUpperCase() + direction.slice(1),
                            bubbles: true
                        });
                        window.dispatchEvent(event);
                    });
                    
                    button.addEventListener('mouseup', function(e) {
                        this.classList.remove('active');
                    });
                });
            }
            
            // Make sure all game buttons work on touch devices
            ['makeNoise', 'bangTree', 'eatMushroom', 'startButton', 'nextLevelButton', 'restartButton'].forEach(id => {
                const btn = document.getElementById(id);
                if (btn) {
                    btn.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        this.classList.add('active');
                        setTimeout(() => this.click(), 50);
                    });
                    
                    btn.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        setTimeout(() => this.classList.remove('active'), 200);
                    });
                }
            });
        });
        
        // Adjust on resize
        window.addEventListener('resize', function() {
            const mobileControls = document.getElementById('mobileControls');
            const gameBoard = document.getElementById('gameBoard');
            
            if (window.innerWidth <= 768 && gameBoard) {
                mobileControls.classList.remove('hidden');
                const availableWidth = window.innerWidth - 40;
                const cellSize = Math.max(18, Math.floor(availableWidth / 15));
                gameBoard.style.gridTemplateColumns = `repeat(15, ${cellSize}px)`;
                gameBoard.style.gridTemplateRows = `repeat(15, ${cellSize}px)`;
            }
        });
    </script>
</body>
</html>
